<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="linedb-the-partitioned-array-managed-partitioned-array-and-file-context-managed-partitioned-array-manager-and-the-partitioned-array-database-fundamental-data-structures-and-array-of-hashes-database-system">LineDB, The Partitioned Array, Managed Partitioned Array and File Context Managed Partitioned Array/Manager, and the Partitioned Array Database: Fundamental Data Structures and Array-Of-Hashes Database System</h1>

<ul>
<li><strong>YARD Documentation</strong>: <a href="https://midscore.io/partitioned_array_library/doc/index.html">https://midscore.io/partitioned_array_library/doc/index.html</a> (Last Updated: 1/13/2023)</li>
<li><strong>Source Code</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/tree/master/lib">https://github.com/ZeroPivot/partitioned_array/tree/master/lib</a></li>
<li><strong>GitHub README</strong>: <a href="https://github.com/ZeroPivot/partitioned_array#readme">https://github.com/ZeroPivot/partitioned_array#readme</a></li>
</ul>

<h2 id="update-1-25-2023-linedb-partitioned-array-library-writeup">Update - 1/25/2023 - LineDB/Partitioned Array Library Writeup</h2>

<p><a href="https://github.com/ZeroPivot/partitioned_array/tree/master/LineDB">https://github.com/ZeroPivot/partitioned_array/tree/master/LineDB</a></p>

<h2 id="update-1-12-2023-5-00am-linedb">Update 1/12/2023 (5:00AM) - LineDB</h2>

<h3 id="linedb-database-class-for-the-partitioned-array-database">LineDB database class for the Partitioned Array Database</h3>

<p>Location: <code>lib/line_db.rb</code></p>

<h4 id="linedb-setup">LineDB Setup</h4>

<p>Works in tandem with <code>lib/line_database_setup.rb</code>; the setup file creates the database text file and LineDB loads those files into a hash object that points to each Partitioned Array Database, which LineDB uses.</p>

<h2 id="update-1-13-2023-2-28am-the-line-reader-and-line-database">Update 1/13/2023 (2:28AM) - the line reader and line database</h2>

<h3 id="line-database-line-reader-line-database-setup">Line Database, Line Reader, Line Database Setup</h3>

<p>Created a set of helper functions to maintain a hash array set of Partitioned Array Databases:
<code>lib/line_reader.rb</code></p>

<p>Helper functions to deal with line_database
<code>lib/line_database_setup.rb</code></p>

<p>Setup the PartitionedArrayManager databases; specify the database names you want, which is written to a file.
<code>lib/line_database.rb</code></p>

<p><code>load_pad</code> helper function will load db_list.txt into a hash with those names referring to the PAM database objects</p>

<h2 id="update-1-12-2023-10-23pm-the-partitioned-array-database">Update 1/12/2023 (10:23PM) - The Partitioned Array Database</h2>

<p>In -- <a href="https://github.com/ZeroPivot/partitioned_array/tree/master/lib:">https://github.com/ZeroPivot/partitioned_array/tree/master/lib:</a></p>

<ul>
<li><strong>Partitioned Array Database</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/blob/master/lib/partitioned_array_database.rb">https://github.com/ZeroPivot/partitioned_array/blob/master/lib/partitioned_array_database.rb</a></li>
<li><strong>FileContextManagedPartitionedArrayManager</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/blob/master/lib/file_context_managed_partitioned_array_manager.rb">https://github.com/ZeroPivot/partitioned_array/blob/master/lib/file_context_managed_partitioned_array_manager.rb</a></li>
<li><strong>FileContextManagedPartitionedArray</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/blob/master/lib/file_context_managed_partitioned_array.rb">https://github.com/ZeroPivot/partitioned_array/blob/master/lib/file_context_managed_partitioned_array.rb</a></li>
<li><strong>ManagedPartitionedArray</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/blob/master/lib/managed_partitioned_array.rb">https://github.com/ZeroPivot/partitioned_array/blob/master/lib/managed_partitioned_array.rb</a></li>
<li><strong>PartitionedArray</strong>: <a href="https://github.com/ZeroPivot/partitioned_array/blob/master/lib/partitioned_array.rb">https://github.com/ZeroPivot/partitioned_array/blob/master/lib/partitioned_array.rb</a></li>
</ul>

<p>All in <a href="https://github.com/ZeroPivot/partitioned_array/tree/master/lib">https://github.com/ZeroPivot/partitioned_array/tree/master/lib</a></p>

<h2 id="synopsis">Synopsis</h2>

<h3 id="partitioned-array-database-managed-partitioned-array-file-context-managed-partitioned-array-manager">Partitioned Array [Database] | Managed Partitioned Array / File Context Managed Partitioned Array [Manager]</h3>

<p>Partitioned Array Library Repo: <a href="https://github.com/ZeroPivot/partitioned_array">https://github.com/ZeroPivot/partitioned_array</a></p>

<ul>
<li>README: <a href="https://github.com/ZeroPivot/partitioned_array#readme">https://github.com/ZeroPivot/partitioned_array#readme</a></li>
<li>YARD Documentation: <a href="https://midscore.io/partitioned_array_library/doc/index.html">https://midscore.io/partitioned_array_library/doc/index.html</a></li>
</ul>

<h3 id="usage">Usage</h3>

<ul>
<li>Installation</li>
</ul>

<p><code>git clone https://github.com/ZeroPivot/partitioned_array.git</code></p>

<ul>
<li>In Ruby:</li>
</ul>

<p><code>require &#39;lib/file_context_managed_partitioned_array_manager&#39;</code></p>

<p>or</p>

<p><code>require &#39;lib/partitioned_array_database</code></p>

<ul>
<li>Data structures available:</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="LineDB.html" title="LineDB (class)">LineDB</a></span></span>
<span class='const'><span class='object_link'><a href="PartitionedArrayDatabase.html" title="PartitionedArrayDatabase (class)">PartitionedArrayDatabase</a></span></span>
<span class='const'><span class='object_link'><a href="FileContextManagedPartitionedArrayManager.html" title="FileContextManagedPartitionedArrayManager (class)">FileContextManagedPartitionedArrayManager</a></span></span>
<span class='const'><span class='object_link'><a href="FileContextManagedPartitionedArray.html" title="FileContextManagedPartitionedArray (class)">FileContextManagedPartitionedArray</a></span></span>
<span class='const'><span class='object_link'><a href="ManagedPartitionedArray.html" title="ManagedPartitionedArray (class)">ManagedPartitionedArray</a></span></span>
<span class='const'><span class='object_link'><a href="PartitionedArray.html" title="PartitionedArray (class)">PartitionedArray</a></span></span>
</code></pre>

<ul>
<li>Helper Functions</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_pad_hash_database'>pad_hash_database</span> <span class='op'>=</span> <span class='id identifier rubyid_load_pad'><span class='object_link'><a href="top-level-namespace.html#load_pad-instance_method" title="#load_pad (method)">load_pad</a></span></span> <span class='comment'># lib/line_database.rb
</span></code></pre>

<ul>
<li>&quot;Inheritance Tree&quot;</li>
</ul>

<p><code>PartitionedArrayDatabase.FileContextManagedPartitonedArrayManager.FileContextManagedPartitionedArray.(ManagedPartitionedArray &lt; PartitionedArray)</code></p>

<ul>
<li>Example:</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FileContextManagedPartitionedArrayManager.html" title="FileContextManagedPartitionedArrayManager (class)">FileContextManagedPartitionedArrayManager</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FileContextManagedPartitionedArrayManager.html#initialize-instance_method" title="FileContextManagedPartitionedArrayManager#initialize (method)">new</a></span></span>

<span class='op'>...</span>

<span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_database_table'>database_table</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>database</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>table</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='comment'># Resembles the &quot;inheritance&quot; tree in terms of object calls, and ManagedPartitionedArray &lt; PartitionedArray implies that ManagedPartitionedArray inherits from PartitionedArray, and MPA &lt; PA is being called with get(0)
</span></code></pre>

<h2 id="updates">Updates</h2>

<ul>
<li><p>January 10, 2023</p>

<ul>
<li>FileContextManagedPartitionedArray (v1.0.5 release) and FileContextManagedPartitionedArrayManager (v2.0.5 release) reached a stable state, and are ready for use and battle testing</li>
<li>Advice: Use the FileContextManagedPartitionedArrayManager class; it is the most high level and features a NoSQL database-like interface</li>
<li><code>YARD Documentation</code> is more comprehensive (<a href="https://midscore.io/partitioned_array_library/doc/index.html">https://midscore.io/partitioned_array_library/doc/index.html</a>)</li>
</ul></li>
<li><p>January 3, 2023 (1/3/2023) - 1:00PM - Added FileContextManagedPartitionedArrayManager info on implementation at the end of README.md; this is the final product for the partitioned array, and turns it into a database</p></li>
<li><p>TODO: Add documentation on the FileContextManagedPartitionedArrayManager class, and the FileContextManagedPartitionedArray class, like a quick tutorial</p></li>
</ul>

<h2 id="quick-compatibility-list"><strong>Quick Compatibility List</strong></h2>

<ul>
<li><p><strong>Ruby 3.0-3.2+</strong>: (<code>/lib/partitioned_array</code>) - <em>lib/managed_partitioned_array.rb</em> - <strong>Fully Compatible</strong></p></li>
<li><p><strong>jruby</strong>: (<code>same as ruby 3.0 version</code>)  - <em>lib/managed_partitioned_array.rb</em> - <strong>Fully Compatible</strong></p></li>
<li><p><strong>DragonRuby</strong>: (<code>/lib/dr_partitioned_array</code>) - <em>dr_managed_partitioned_array.rb</em> - <strong>Fully Compatible</strong> -- not synchronized with FileContextManagedPartitionedArray(Manager) yet (1/20/2023 - 4:45AM)</p></li>
<li><p><strong>Python</strong>: <em>./managed_partitioned_array_python</em> folder - <strong>(WIP)</strong></p></li>
<li><p><strong>NOTE</strong>: File Context Managed Partitioned Array/Manager (lib/file_context_managed_partitioned_array.rb / lib/file_context_managed_partitioned_array_manager.rb [&quot;FCMPA/FCMPAM&quot;]) are in the same <code>lib</code> folder; documentation at the bottom</p></li>
</ul>

<h2 id="initial-notes">Initial Notes</h2>

<p>(There is much less need for the basis partitioned_array.rb, as managed_partitioned_array.rb does everything, and more.)</p>

<p>Note: Managed partitioned array info is near the bottom of this README.md file, and will be updated accordingly; just need to get a bearing on how im going to write this documentation (Last updated: 10/19/2022 12:11PM)</p>

<p>See: CHANGELOG.md for a list of changes</p>

<h2 id="update-11-18-2022">Update 11/18/2022</h2>

<ul>
<li>Added FileContextManagedPartitionedArray info on implementation at the end of README.md</li>
<li>Information on HTTP/HTTPS implementation of a <code>FCMPA</code> in <code>HTTPS_FCMPA_README.md</code></li>
</ul>

<h2 id="update-9-25-2021">Update 9/25/2021</h2>

<p>In case one&#39;s wondering, the additional layer of abstraction is called a ManagedPartitionedArray, which keeps a track of the array index and inherits from PartitionedArray. When I go to work today 2-4 hours from now I&#39;m going to work on the ManagedPartitionedArray Documentation. -ArityWolf</p>

<h2 id="wip-notes-last-updated-9-14-2022">WIP NOTES (Last Updated: 9/14/2022)</h2>

<p>In recent developments, this only describes the low-level ish nature of a PartitionedArray data structure, and even that is still incomplete.</p>

<p>In the lib folder, I have completed the (inherited from PartitonedArray) ManagedPartitionedArray class which describes how to treat a PartitionedArray closer to an array with bounds set to it, and that is what the main focus of the rest of this documentation will be about. In the end, everything about the data structure will be described in full detail.</p>

<p>You can think of a partitioned array in general as an array that has disk I/O and saves the data in .json, but it could be extended to deal with whatever you throw at it</p>

<p>It will also be fully compatible with the DragonRuby game development toolkit albeit with a few minor caveats, and several details that need to be addressed in some way</p>

<h3 id="later-goals">Later Goals</h3>

<ul>
<li><p>Documentation on all code on this page, leaving nothing out</p></li>
<li><p>Prettify the code, and make as efficient as possible</p></li>
<li><p>Lower level language implementation(s)</p></li>
<li><p>DragonRuby file I/O implementation, aimed at both Linux/Windows</p></li>
</ul>

<hr>

<h3 id="everything-below-this-line-needs-to-be-updated">Everything below this line needs to be updated</h3>

<p>(But it does document the PartitionedArray class alright thus far)</p>

<ul>
<li>Upcoming additions: ManagedPartitonedArray documentation, and cleaned up PartitionedArray documentation</li>
</ul>

<h2 id="synopsis">Synopsis</h2>

<p>A partitioned array is defined as a datastructure which has &quot;partitioned elements&quot; within what should be a <code>regular array</code></p>

<p>The data structure used for every element in the array is a Ruby Hash, or otherwise known as an Associative Array</p>

<p>Example of how a <code>partitioned array</code> is structured:</p>

<p><code>figure 69 (partitioned array structure):</code>
<code>[[0, 1, 2], [3, 4], ..., [n, ..., n+1]]</code></p>

<p><code>Caveat</code>: The first partition (<code>[0,1,2]</code> always contains the 0th element otherwise known as <code>0</code> )</p>

<p>However, as a note: The partitioned array algorithm is currently coded in a way that it does not actually use subarrays; the algorithm takes responsibility for all aspects of the data structure (partitions, ranges, etc), so an array when defined by <code>fig 69</code>, would look slightly different, it would look like...</p>

<p><code>[0, 1, 2, 3, 4, n, n+1, n+2, ..., n+k]</code></p>

<p>Note: The basic idea is you can store the array itself onto disk and &quot;switch off&quot; certain partitions, thus allowing for Ruby&#39;s Garbage collector to take hold</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require_relative'>require_relative</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>partitioned_array</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_pa'>pa</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="PartitionedArray.html" title="PartitionedArray (class)">PartitionedArray</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="PartitionedArray.html#initialize-instance_method" title="PartitionedArray#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_allocate'>allocate</span>

<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>

<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='comment'># =&gt; &quot;Get an element of the partitioned array, using binary search&quot;
</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_delete_partition_subelement'>delete_partition_subelement</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_partition_id'>partition_id</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_set_partition_subelement'>set_partition_subelement</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_partition_id'>partition_id</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_delete_partition'>delete_partition</span><span class='lparen'>(</span><span class='id identifier rubyid_partition_id'>partition_id</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_get_partition'>get_partition</span><span class='lparen'>(</span><span class='id identifier rubyid_partition_id'>partition_id</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_add_partition'>add_partition</span>

<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_add_partition'>add_partition</span> <span class='comment'>#=&gt; &quot;dynamically allocates new partition sub-elements to the partitioned array, as defined by the constants&quot;
</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_load_from_files!'>load_from_files!</span> <span class='comment'>#=&gt; loads database from json files, using Ruby&#39;s JSON parser
</span><span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_load_partition_from_file!'>load_partition_from_file!</span><span class='lparen'>(</span><span class='id identifier rubyid_partiion_id'>partiion_id</span><span class='rparen'>)</span> <span class='comment'>#=&gt; loads a given partition id from the @data_arr array
</span><span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_save_partition_to_file!'>save_partition_to_file!</span>
<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_save_all_to_files!'>save_all_to_files!</span>

<span class='id identifier rubyid_pa'>pa</span><span class='period'>.</span><span class='id identifier rubyid_dump_to_json!'>dump_to_json!</span>

<span class='embdoc_beg'>=begin
</span><span class='embdoc'>The above is basic usage for the partitioned array data structure. For tested code and configuration options, see below.
</span><span class='embdoc_end'>=end
</span></code></pre>

<p><strong>WIP.</strong> - <strong><em>Last updated: 4.27.2022</em></strong></p>

<p>A partitioned array data structure which works with JSON for disk storage, and a pure JSON parser is in progress. With two constants, the algorithm creates a data structure and allocates empty associative array elements and understands the structure of the partitions.</p>

<p>The main purpose was I needed a way to divide an array into subelements, so that in gamedev I can flip on and off portions of the array in question to save on memory.</p>

<p>The data structure overall is an <code>Array-Of-Hashes</code>.</p>

<h2 id="usage">Usage</h2>

<h3 id="assumed-constants">Assumed Constants</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># DB_SIZE &gt; PARTITION_AMOUNT
</span><span class='const'>PARTITION_AMOUNT</span> <span class='op'>=</span> <span class='int'>5</span> <span class='comment'># Number of subelements per partition. CAVEAT: the first partition quantity is always PARTITION_AMOUNT + 1
</span><span class='const'>DB_SIZE</span> <span class='op'>=</span> <span class='int'>3</span> <span class='comment'># The DB_SIZE is the total # of partitions within the array; starts at 0
</span><span class='const'>OFFSET</span> <span class='op'>=</span> <span class='int'>1</span> <span class='comment'># This came with the math
</span><span class='const'>PURE_RUBY</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='comment'># WIP
</span><span class='const'>DB_NAME</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>partitioned_array_slice</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>DEFAULT_PATH</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./CGMFS</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>DEBUGGING</span> <span class='op'>=</span> <span class='kw'>false</span>
</code></pre>

<h3 id="examples">Examples</h3>

<p><code>main_refined.rb, visuals.rb</code></p>

<p>Visualization of the partitions within <code>@data_arr</code></p>

<p><code>visuals.rb</code></p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Visuals; Show the basic data structure, by filling with entries, where each id is a part of that respective array partition
</span><span class='kw'>def</span> <span class='id identifier rubyid_allocate_ranges_sequentially'>allocate_ranges_sequentially</span><span class='lparen'>(</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_range_arr'>range_arr</span> <span class='op'>=</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_range_arr'>range_arr</span>
  <span class='id identifier rubyid_range_arr'>range_arr</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_range'>range</span><span class='comma'>,</span> <span class='id identifier rubyid_range_index'>range_index</span><span class='op'>|</span>
    <span class='id identifier rubyid_range'>range</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_range_element'>range_element</span><span class='comma'>,</span> <span class='id identifier rubyid_range_element_index'>range_element_index</span><span class='op'>|</span>
      <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_set_partition_subelement'>set_partition_subelement</span><span class='lparen'>(</span><span class='id identifier rubyid_range_element_index'>range_element_index</span><span class='comma'>,</span> <span class='id identifier rubyid_range_index'>range_index</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_partition_subelement'>partition_subelement</span><span class='op'>|</span>
        <span class='id identifier rubyid_partition_subelement'>partition_subelement</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_range_index'>range_index</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_data_arr'>data_arr</span>
<span class='kw'>end</span>
</code></pre>

<p><code>main_refined.rb</code></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require_relative'>require_relative</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>partitioned_array</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require_relative'>require_relative</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>visuals</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Create a new data structure and allocate the partition to memory
</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="PartitionedArray.html" title="PartitionedArray (class)">PartitionedArray</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="PartitionedArray.html#initialize-instance_method" title="PartitionedArray#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_allocate'>allocate</span>

<span class='comment'>#Returns the partition elements within the first partition within @data_arr; returns a hash of relevant data if argument is true (optional)
</span><span class='comment'># Examples
</span><span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>First Partition in @data_arr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_get_partition'>get_partition</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>hash:</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># get a partition (a chunk) of a partition element withinn @data_arr
</span><span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>First Element in @data_arr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitoned_array'>partitoned_array</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># gets an entry from @data_arr directly
</span><span class='id identifier rubyid_puts'>puts</span>

<span class='comment'># Set an element within @data_arr; ignores partitions and goes for raw ids
</span>
<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
   <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1st</span><span class='tstring_end'>&quot;</span></span>   
<span class='kw'>end</span>

<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2nd</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>

<span class='comment'># add a partition to the @range_arr; @data_arr, add partition_amount_andoffset to @rel_arr, @db_size increases by one
</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_add_partition'>add_partition</span> 
<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_add_partition'>add_partition</span>

<span class='id identifier rubyid_allocate_ranges_sequentially'>allocate_ranges_sequentially</span><span class='lparen'>(</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='rparen'>)</span>

<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_add_partition'>add_partition</span>

<span class='id identifier rubyid_last_element'>last_element</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_last_element'>last_element</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>last</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nth</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>

<span class='comment'># All that has to be done to store the PartitionedArray instance data
</span><span class='embdoc_beg'>=begin
</span><span class='embdoc'>PartitionedArray#load_from_json!()
</span><span class='embdoc'>PartitionedArray#dump_to_json!
</span><span class='embdoc'>PartitionedArray#save_partition_to_file!
</span><span class='embdoc'>PartitionedArray#load_partition_from_file!
</span><span class='embdoc_end'>=end
</span>
<span class='comment'># Test to see if file loading and unloading creates equivalent data structures
</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Before:</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_data_arr'>data_arr</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_partition_amount_and_offset'>partition_amount_and_offset</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_range_arr'>range_arr</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_rel_arr'>rel_arr</span>

<span class='id identifier rubyid__data_arr'>_data_arr</span> <span class='op'>=</span> <span class='id identifier rubyid_partitoned_array'>partitoned_array</span><span class='period'>.</span><span class='id identifier rubyid_data_arr'>data_arr</span>
<span class='id identifier rubyid__partition_amount_and_offset'>_partition_amount_and_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_partition_amount_and_offset'>partition_amount_and_offset</span>
<span class='id identifier rubyid__range_arr'>_range_arr</span> <span class='op'>=</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_range_arr'>range_arr</span>
<span class='id identifier rubyid__rel_arr'>_rel_arr</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_rel_arr'>rel_arr</span>

<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_dump_to_json!'>dump_to_json!</span>
<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_load_from_json!'>load_from_json!</span>

<span class='comment'># assert tests
</span><span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@data_arr remains the same: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_data_arr'>data_arr</span> <span class='op'>==</span> <span class='id identifier rubyid__data_arr'>_data_arr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@partition_amount_and_offset: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_partition_amount_and_offset'>partition_amount_and_offset</span> <span class='op'>==</span> <span class='id identifier rubyid__partition_amount_and_offset'>_partition_amount_and_offset</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@range_arr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_range_arr'>range_arr</span> <span class='op'>==</span> <span class='id identifier rubyid__range_arr'>_range_arr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@rel_arr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_rel_arr'>rel_arr</span> <span class='op'>==</span> <span class='id identifier rubyid__rel_arr'>_rel_arr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Get a certain slice of @data_arr (0..4): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitiond_array'>partitiond_array</span><span class='period'>.</span><span class='id identifier rubyid_data_arr'>data_arr</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>4</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Load partition data into @data_arr (0th): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_load_partition_from_file!'>load_partition_from_file!</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_save_partition_to_file!'>save_partition_to_file!</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>

<span class='comment'># PartitionedArray#set_partition_subelement(id, partition_id, &amp;block)
</span><span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='id identifier rubyid_partitioned_array'>partitioned_array</span><span class='period'>.</span><span class='id identifier rubyid_set_partition_subelement'>set_partition_subelement</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='symbol'>:modified</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0, 0</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>successfully modified partition subelement: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_success'>success</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New @data_arr: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@data_arr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

</code></pre>

<p>Output</p>

<pre class="code ruby"><code class="ruby">&quot;First Partition in @data_arr: [{}, {}, {}, {}, {}, {}, {}]&quot;
&quot;First Element in @data_arr: {}&quot;

Before:
[{&quot;first&quot;=&gt;&quot;1st&quot;, &quot;id&quot;=&gt;0}, {&quot;second&quot;=&gt;&quot;2nd&quot;, &quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {}, {}, {}, {}, {}, {&quot;last&quot;=&gt;&quot;Nth&quot;}]
6
[0..6, 7..12, 13..18, 19..24, 25..30, 31..36]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 18, 19, 20, 21, 22, 23, 24, 24, 25, 26, 27, 28, 29, 30, 30, 31, 32, 33, 34, 35, 36]
&quot;@data_arr remains the same: true&quot;
&quot;@partition_amount_and_offset: true&quot;
&quot;@range_arr: true&quot;
&quot;@rel_arr: true&quot;
&quot;Get a certain slice of @data_arr (0..4): [{&quot;first&quot;=&gt;&quot;1st&quot;, &quot;id&quot;=&gt;0}, {&quot;second&quot;=&gt;&quot;2nd&quot;, &quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}]&quot;
&quot;Load partition data into @data_arr (0th): [{&quot;first&quot;=&gt;&quot;1st&quot;, &quot;id&quot;=&gt;0}, {&quot;second&quot;=&gt;&quot;2nd&quot;, &quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}]&quot;
&quot;successfully modified partition subelement: true&quot;
&quot;New @data_arr: [{&quot;first&quot;=&gt;&quot;1st&quot;, &quot;id&quot;=&gt;0, :modified=&gt;&quot;0, 0&quot;}, {&quot;second&quot;=&gt;&quot;2nd&quot;, &quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;0}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;1}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;2}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;3}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {&quot;id&quot;=&gt;4}, {}, {}, {}, {}, {}, {&quot;last&quot;=&gt;&quot;Nth&quot;}]&quot;
</code></pre>

<h2 id="managed-partitioned-array-data-structure">Managed Partitioned Array Data Structure</h2>

<h3 id="synopsis-partitionedarray-managedpartitionarray">Synopsis - PartitionedArray/ManagedPartitionArray</h3>

<p>This will talk about the Partitioned Array and its suggested counterpart superset, the<code>ManagedPartitionedArray (lib/managed_partitioned_array.rb)</code></p>

<h4 id="managedpartitionedarray">ManagedPartitionedArray</h4>

<p>(Last updated: 10/19/2022 12:11PM)</p>

<h4 id="instance-methods">Instance Methods</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_archive_and_new_db!'>archive_and_new_db!</span>

<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_load_archive_no_auto_allocate!'>load_archive_no_auto_allocate!</span>

<span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_load_from_archive!'>load_from_archive!</span><span class='lparen'>(</span><span class='label'>partition_archive_id:</span> <span class='ivar'>@max_partition_archive_id</span><span class='rparen'>)</span>

<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_at_capacity?'>at_capacity?</span> <span class='comment'># Depends on the MPA variables
</span>
<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='label'>return_added_element_id:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>hash:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='comment'>#see PartitionedArray
</span>
<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_load_everything_from_files!'>load_everything_from_files!</span> <span class='comment'># in PA class, its load_all_from_files!
</span>
<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_save_everything_to_files!'>save_everything_to_files!</span>

<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_increment_max_partition_archive_id!'>increment_max_partition_archive_id!</span>
</code></pre>

<h4 id="finite-length-arrays">Finite Length arrays</h4>

<pre class="code ruby"><code class="ruby">
<span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ManagedPartitionedArray.html" title="ManagedPartitionedArray (class)">ManagedPartitionedArray</a></span></span><span class='lparen'>(</span><span class='label'>max_capacity:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data_arr_size</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='const'>Integer</span><span class='comma'>,</span> <span class='label'>dynamically_allocates:</span> <span class='kw'>false</span><span class='rparen'>)</span>
</code></pre>

<p>Capable of jumping to a new file partition</p>

<h3 id="never-ending-array-adds">Never ending array adds</h3>

<pre class="code ruby"><code class="ruby">
mpa = ManagedPartitionedArray.new(endless_add: true, has_capacity: false, dynamically_allocates: true)`
</code></pre>

<h4 id="dynamic-allocation">Dynamic Allocation</h4>

<pre class="code ruby"><code class="ruby">
<span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ManagedPartitionedArray.html" title="ManagedPartitionedArray (class)">ManagedPartitionedArray</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ManagedPartitionedArray.html#initialize-instance_method" title="ManagedPartitionedArray#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>dynamically_allocates:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<h4 id="array-split-by-file-partitions">Array split by file partitions</h4>

<pre class="code ruby"><code class="ruby"> <span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ManagedPartitionedArray.html" title="ManagedPartitionedArray (class)">ManagedPartitionedArray</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ManagedPartitionedArray.html#initialize-instance_method" title="ManagedPartitionedArray#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>max_capacity:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data_arr_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='label'>db_size:</span> <span class='const'>DB_SIZE</span><span class='comma'>,</span>   <span class='label'>partition_amount_and_offset:</span> <span class='const'>PARTITION_AMOUNT</span> <span class='op'>+</span> <span class='const'>OFFSET</span><span class='comma'>,</span>   <span class='label'>db_path:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>./db/sl</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='label'>db_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sl_slice</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Where <code>max_capacity</code> could be the max <code>@data_arr</code> size, or a defined integer</p>

<p>Check if <code>mpa.at_capacity?</code> to figure out if the MPA is at capacity</p>

<h4 id="switching-and-allocating-to-a-new-file-partition">Switching and allocating to a new file partition</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ManagedPartitionedArray.html" title="ManagedPartitionedArray (class)">ManagedPartitionedArray</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ManagedPartitionedArray.html#initialize-instance_method" title="ManagedPartitionedArray#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>max_capacity:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data_arr_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='label'>db_size:</span> <span class='const'>DB_SIZE</span><span class='comma'>,</span>   <span class='label'>partition_amount_and_offset:</span> <span class='const'>PARTITION_AMOUNT</span> <span class='op'>+</span> <span class='const'>OFFSET</span><span class='comma'>,</span>   <span class='label'>db_path:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>./db/sl</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='label'>db_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sl_slice</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_mpa'>mpa</span> <span class='op'>=</span> <span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_archive_and_new_db!'>archive_and_new_db!</span>
<span class='id identifier rubyid_mpa'>mpa</span><span class='period'>.</span><span class='id identifier rubyid_save_everything_to_files!'>save_everything_to_files!</span>
</code></pre>

<p>It implements the Value Object pattern; the other archive is closed and saved and the partitioned array starts out in a new partition that mirrors the others if max_capacity = &quot;data_arr_size&quot;</p>

<p>&quot;data_arr_size&quot; is sure to fill the entire array before throwing  at_capacity? is true.</p>

<h4 id="file-context-managed-partitioned-array-definition">File Context Managed Partitioned Array (Definition)</h4>

<p>We have: <code>file_context_array[&quot;file_db_name_string&quot;].managed_partitioned_array[mpa_db_file_id_integer].partitioned_array(db_id, id)</code></p>

<p>let <code>PA (partitioned array) = P</code></p>

<p>let <code>MPA = a = Q &lt; P</code></p>

<p>let <code>FCA = f = b&lt;a ~= b.a</code></p>

<p><code>f</code> expands to <code>f.(Q &lt; P)</code> =&gt; <code>f.(b &lt; a)</code> =~&gt; <code>f.(b.a)</code></p>

<p>and, </p>

<p>we have in this context:</p>

<p><code>file_context_array[&quot;file_db_name_string&quot;].managed_partitioned_array[mpa_db_file_id_integer].partitioned_array(db_id, id)</code></p>

<p>Could also be written as: <code>file_context_array[&quot;file_db_name_string&quot;].(managed_partitioned_array[mpa_db_file_id_integer] &lt; partitioned_array(db_id, id))</code></p>

<p>Methods:</p>

<ul>
<li>VERSION v1.0.2a - Prettified, and listed all functions below</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='const'>FCMPA</span><span class='comment'>#load_indexer_db! - loads the indexing DB
</span>
<span class='const'>FCMPA</span><span class='comment'>#new_database! - creates a new database
</span>
<span class='const'>FCMPA</span><span class='comment'>#start_database! - starts a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#delete_database_from_index! - deletes a database from the index
</span>
<span class='const'>FCMPA</span><span class='comment'>#add_database_to_index! - adds a database to the index
</span>
<span class='const'>FCMPA</span><span class='comment'>#db(database_index_name = @active_database) - returns the database
</span>
<span class='const'>FCMPA</span><span class='comment'>#set_active_database(database_index_name) - sets the active database
</span>
<span class='const'>FCMPA</span><span class='comment'>#stop_database!(database_index_name) - stops a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#stop_databases! - stops all databases
</span>
<span class='const'>FCMPA</span><span class='comment'>#save_databases! - saves all databases
</span>
<span class='const'>FCMPA</span><span class='comment'>#load_database!(database_index_name = @active_database) - loads a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#load_databases! - loads all databases
</span>
<span class='const'>FCMPA</span><span class='comment'>#delete_database!(database_index_name = @active_database) - deletes a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#get_databases_list - returns a list of databases
</span>
<span class='const'>FCMPA</span><span class='comment'>#set_new_file_archive!(database_index_name = @active_database) - sets a new file archive for a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#each(database_index_name, hash: @traverse_hash) - traverses a database
</span>
<span class='const'>FCMPA</span><span class='comment'>#each_not_nil(database_index_name, hash: @traverse_hash) - traverses a database, skipping nil values
</span></code></pre>

<h4 id="file-context-managed-partitioned-array-manager-definition">File Context Managed Partitioned Array <em>Manager</em> (Definition)</h4>

<p>The database manager is the <code>FCMPAM</code> class. It is a singleton class that manages the <code>FCMPA</code> class. The <code>FCMPA</code> class manages the <code>MPA</code> class. The <code>MPA</code> class manages the <code>PA</code> class.</p>

<p>FCMPAM.FCMPA.MPA.PA or FCMPAM.FCMPA.(MPA &lt; PA)</p>

<h2 id="defined-methods-fcmpam-file-context-managed-partitioned-array-manager-file_context_managed_partitioned_array_manager-rb">Defined Methods (FCMPAM = File Context Managed Partitioned Array Manager = file_context_managed_partitioned_array_manager.rb)</h2>

<pre class="code ruby"><code class="ruby"><span class='const'>FCMPAM</span><span class='comment'>#database(database_name = @active_database): returns the database object
</span>
<span class='const'>FCMPAM</span><span class='comment'>#database_table(database_name: @active_database, database_table: @active_table): returns the database table object
</span>
<span class='const'>FCMPAM</span><span class='comment'>#new_database!(database_name): creates a new database
</span>
<span class='const'>FCMPAM</span><span class='comment'>#new_table!(database_name:, database_table:): creates a new table in the database
</span>
<span class='const'>FCMPAM</span><span class='comment'>#active_database(database_name): sets the active database
</span>
<span class='const'>FCMPAM</span><span class='comment'>#active_table(database_table): sets the active table
</span>
<span class='const'>FCMPAM</span><span class='comment'>#table(database_table = @active_table): returns the active table
</span>
<span class='const'>FCMPAM</span><span class='comment'>#database(database_name = @active_database): returns the active database
</span></code></pre>

<h2 id="generate-documentation">Generate Documentation</h2>

<p><code>gem install yard</code></p>

<h2 id="in-directory">In Directory:</h2>

<p><code>yard doc</code></p>
</div></div>

      <div id="footer">
  Generated on Fri Mar 31 16:01:15 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.2.1).
</div>

    </div>
  </body>
</html>